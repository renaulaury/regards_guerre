{% extends 'base.html.twig' %}

{% block title %}Panier{% endblock %}

{% block description %}
Consultez en un coup d'œil l'état de vos stocks : niveaux maximum, actuel et d'alerte. 
Identifiez rapidement les produits en rupture ou en seuil critique. 
Accédez également aux statistiques de vente pour une gestion optimale de votre inventaire.
{% endblock %}



{% block body %}
    <h1>Gestion des stocks <br> tickets</h1>

    <section>
        <a class="comeBack" href="javascript:void(0);" onclick="window.history.back();"><i class="fa-solid fa-arrow-left"></i></a>

        <div class="filter-dropdown">
            <label for="stockFilter">Filtrer par :</label>
            <select id="stockFilter" onchange="window.location.href = this.value;">
                <option value="{{ path('stockManagement') }}" {% if currentFilter is null %}selected{% endif %}>
                    Tout afficher
                </option>
                <option value="{{ path('stockManagement', {'filter': 'epuise'}) }}" {% if currentFilter == 'epuise' %}selected{% endif %}>
                    Stock épuisé
                </option>
                <option value="{{ path('stockManagement', {'filter': 'presque-epuise'}) }}" {% if currentFilter == 'presque-epuise' %}selected{% endif %}>
                    Stock presque épuisées
                </option>
            </select>
        </div>

        {% if exhibitionStocks is empty %}
            <p>Aucun stock à afficher selon le filtre sélectionné.</p>
        {% else %}
            {% for stockInfo in exhibitionStocks %}
                <h2>
                    {% if stockInfo.remaining <= 0 %}
                        <i class="iconDanger fa-solid fa-xmark"></i>
                    {% elseif stockInfo.remaining <= stockInfo.exhibition.stockAlert %}
                        <i class="iconWarning fa-solid fa-triangle-exclamation"></i>
                    {% endif %}
                    {{ stockInfo.exhibition }} ({{ stockInfo.exhibition.dateExhibitFr }})
                </h2>

                <p>Stock : {{ stockInfo.exhibition.stockMax }}</p>
                <p>Stock d'alerte : {{ stockInfo.exhibition.stockAlert }}
                    <a href="{{ path('exhibitEditBO', {'slug': stockInfo.exhibition.slug}) }}">
                        <i class="iconsEdit fa-solid fa-pencil"></i>
                    </a>
                </p>

                <p>Réservés : {{ stockInfo.reserved }}</p>
                <p>Reste : {{ stockInfo.remaining }}</p>
            {% endfor %}
        {% endif %}
    </section>
{% endblock %}

{% block stylesheets %}
    
{% endblock %}