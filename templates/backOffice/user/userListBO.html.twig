{% extends 'base.html.twig' %}

{% block title %}Liste des utilisateurs{% endblock %}

{% block body %}

<h1>Back-Office</h1>
<!-- UserBOController -->

<section class="listMembers">
    {% if app.user %}
        <p class="thUsers">Pseudo</p>
        <p class="thUsers">Email</p>
        <p class="thUsers">Rôle</p>
        <p></p>

        {% if is_granted('ROLE_ROOT') %}
            {# Affiche tous les membres sauf ceux avec le rôle ROLE_ROOT #}
            {% for member in members %}
                {% if not is_granted('ROLE_ROOT', member) %} {# Root non affiché #}
                    <p>{{ member.userNickname }}</p>
                    <p>{{ member.userEmail }}</p>

                    {% if is_granted('ROLE_ADMIN', member) %}
                        <p>Administrateur</p>
                    {% elseif is_granted('ROLE_USER', member) %}
                        <p>Utilisateur</p>
                    {% endif %}

                    <p>
                        <a href="{{ path('userEditBO', {'id': member.id}) }}">
                            <i class="fa-solid fa-pencil"></i>
                        </a>
                        <a href="{{ path('userDeleteBO', {'id': member.id}) }}">
                            <i class="fa-solid fa-trash-can"></i>
                        </a>
                    </p>
                {% endif %}
            {% endfor %}

        {% elseif is_granted('ROLE_ADMIN') %}
            {% for user in users %}
                {% if not is_granted('ROLE_ROOT', user) %}
                    <p>{{ user.userNickname }}</p>
                    <p>{{ user.userEmail }}</p>

                    {% if is_granted('ROLE_ADMIN', user) %}
                        <p>Administrateur</p>
                        <p></p>
                    {% elseif is_granted('ROLE_DELETE', user) %}
                        <p>Supprimé</p>
                        <p></p>
                    {% elseif is_granted('ROLE_USER', user) %}
                        <p>Utilisateur</p>
                        <p>
                            <a href="{{ path('userOrderBO', {'id': user.id}) }}"><i class="fa-regular fa-folder-open"></i></a>
                            <a href="{{ path('userEditBO', {'id': user.id}) }}">
                                <i class="fa-solid fa-pencil"></i>
                            </a>
                            <a href="{{ path('userDeleteBO', {'id': user.id}) }}">
                                <i class="fa-solid fa-trash-can"></i>
                            </a>
                        </p>
                    {% endif %}
                {% endif %}
            {% endfor %}
        {% endif %}
    {% endif %}
</section>

{% endblock %}
