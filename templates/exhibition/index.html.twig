{% extends 'base.html.twig' %}

{% block title %}{{ exhibition.titleExhibit}}{% endblock %}

{% block description %}
Plongez dans l'univers de l'exposition "{{ exhibition.titleExhibit }}" ! Découvrez des œuvres d'art poignantes et commandez vos tickets dès maintenant pour une expérience unique.
{% endblock %}

{% block body %}
<!-- ExhibitionController CartController -->

<h1>Exposition</h1>

<section>    
    <a class="comeBack" href="javascript:void(0);" onclick="window.history.back();"><i class="fa-solid fa-arrow-left"></i></a>

    <h2 class="pageExhibitH2">{{ exhibition.titleExhibit}}  
        ({{ exhibition.dateWarBeginFr }} - {{ exhibition.dateWarEndFr }})</h2>

    <div class="dateHourPageExhibit">
        <p>{{ exhibition.dateExhibitFr }}</p>
        <p>{{ exhibition.hourBeginFr }} - {{ exhibition.hourEndFr }}</p>
    </div>

    <div class="blockImgExhibit">
        <img class="expoImg" src="{{ exhibition.mainImage }}" alt="{{ exhibition.mainImageAlt }}">
        {% if exhibition.ticketsRemaining <= 10 and exhibition.ticketsRemaining > 0 %}
            <img class="imgStockExhibit" src="{{ asset('images/stocks/soon_out_of_stock.png') }}" alt="Presque épuisé">
        {% elseif exhibition.ticketsRemaining <= 10 %}
            <img class="imgStockExhibit" src="{{ asset('images/stocks/out_of_stock.png') }}" alt="Epuisé">
        {% endif %}
    </div>

    <p>{{ exhibition.descriptionExhibit }}</p>


{% if exhibition.ticketsRemaining > 0 %}
    <div class="blockTicketsExhibit">
        <h3>Tickets :</h3>

        {% if ticketPricings is not empty %}
            {% for pricing in ticketPricings %}

                <div class="ticketExhibit">
                    <p class="titleTicket">{{ pricing.ticket.titleTicket }}</p>                    
                    
                    <div class="blockTitleQtyTicket">
                        <div class="blockPriceTicket">
                             {% if pricing.standardPrice > 0 %}
                                <p class="price">{{ pricing.standardPrice }} €</p>
                            {% else %}
                                <p class="price">Gratuit</p>
                            {% endif %}
                        </div>

                        <div class="blockQtyTicket">

                            <a href="{{ path('removeTicketFromCart', {'exhibitionId': exhibition.id, 'ticketId': pricing.ticket.id, 'origin': 'ticket'}) }}">
                                <i class="fa-solid fa-minus"></i>
                            </a>

                            <div class="qtyProduct">  
                                {# Crée une clé unique pour le ticket dans le panier (id expo + id ticket) #}                              
                                {% set cartKey = exhibition.id ~ '_' ~ pricing.ticket.id %}
                                
                                {# Vérifie si le ticket est déjà dans le panier #}
                                {% if cart[cartKey] is defined %} 
                                    <span class="nbCart">{{ cart[cartKey].qty }}</span>
                                {% else %}
                                    <span class="nbCart">0</span>
                                {% endif %}
                            </div> 

                            <a href="{{ path('addTicketToCart', {'exhibitionId': exhibition.id, 'ticketId': pricing.ticket.id, 'origin': 'ticket'}) }}">
                                <i class="fa-solid fa-plus"></i>
                            </a>
                        </div>
                    </div>
                    
                </div>
            {% endfor %}
            <div class="btnSubmit">
                <a href="{{ path('cart') }}">Panier</a>
            </div>
        
            
        {% endif %}
    </div>
{% endif %}
</section>


<section class="sectionIntroExhibit">
        <p class="cormorantGaramond"> 
            Regards de Guerre rassemble des artistes aux horizons variés, offrant, à travers un regard neuf, une exploration des conflits d'ici et d'ailleurs. 
        </p>

        <p class="cormorantGaramond">
            Chaque salle vous immerge dans leur univers unique, proposant une perspective inédite sur ces événements marquants.
        </p>
</section>

<section>
    <h2>Galerie des artistes</h2>

    <div>

        {% for show in exhibition.shows %}
        
        <div class="blockArtistPageExhibit">
            <div class="artistInfosPageExhibit">
                <p class="cormorantGaramond">{{ show.artist.artistFirstname }} {{ show.artist.artistName }} - {{ show.artist.artistJob }}</p>
                <p class="cormorantGaramond">({{ show.artist.artistBirthDateFr }} - {{ show.artist.artistDeathDateFr }})</p>
            </div>

            <img class="artistImgPageExhibit" src="{{ show.artistPhoto }}" alt="{{ show.artistPhotoAlt }}">
        </div>

        <div class="artistTextPageExhibit">
            <p>{{ show.artist.artistBio }} </p>
            <p>{{ show.artistTextArt }} </p>
        </div>
    
         <p class="artistRoomPageExhibit">Salle {{ show.room.titleRoom }}</p> 
    {% endfor %}

        
    </div>
</section>


{% endblock %}
